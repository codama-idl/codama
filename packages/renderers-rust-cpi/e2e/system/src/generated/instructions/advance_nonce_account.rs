//! This code was AUTOGENERATED using the Codama library.
//! Please DO NOT EDIT THIS FILE, instead use visitors
//! to add features, then rerun Codama to update it.
//!
//! <https://github.com/codama-idl/codama>

use pinocchio::account_info::AccountInfo;
use pinocchio::cpi::invoke_signed;
use pinocchio::instruction::AccountMeta;
use pinocchio::instruction::Instruction;
use pinocchio::instruction::Signer;
use pinocchio::ProgramResult;

/// `advance_nonce_account` CPI helper.
pub struct AdvanceNonceAccount<'a> {
    pub nonce_account: &'a AccountInfo,
    pub recent_blockhashes_sysvar: &'a AccountInfo,
    pub nonce_authority: &'a AccountInfo,
}

impl AdvanceNonceAccount<'_> {
    #[inline(always)]
    pub fn invoke(&self) -> ProgramResult {
        self.invoke_signed(&[])
    }

    pub fn invoke_signed(&self, signers: &[Signer]) -> ProgramResult {
        // account metas
        let account_metas: [AccountMeta; 3] = [
            AccountMeta::new(self.nonce_account.key(), true, false),
            AccountMeta::new(self.recent_blockhashes_sysvar.key(), false, false),
            AccountMeta::new(self.nonce_authority.key(), false, true),
        ];

        let data = &4u32.to_le_bytes();

        let instruction = Instruction {
            program_id: &crate::ID,
            accounts: &account_metas,
            data,
        };

        invoke_signed(
            &instruction,
            &[
                &self.nonce_account,
                &self.recent_blockhashes_sysvar,
                &self.nonce_authority,
            ],
            signers,
        )
    }
}
